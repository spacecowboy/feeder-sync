# all endpoints
# apiKeyOnly.POST("v1/create", server.handleCreateV1)
# apiKeyOnly.POST("v2/create", server.handleCreateV2)
# apiKeyUserId.POST("v1/join", server.handleJoinV1)
# apiKeyUserId.POST("v2/join", server.handleJoinV2)
# fullyAuthed.GET("v1/ereadmark", server.handleGETReadmarkV1)
# fullyAuthed.POST("v1/ereadmark", server.handlePOSTReadmarkV1)
# fullyAuthed.POST("v1/devices", server.handleDeviceGetV1)
# fullyAuthed.DELETE("v1/devices/:id", server.handleDeviceDeleteV1)
# fullyAuthed.GET("v1/feeds", server.handleGETFeedsV1)
# fullyAuthed.POST("v1/feeds", server.handlePOSTFeedsV1)

- name: v1 Create Happy Path
  request:
    method: POST
    path: /api/v1/create
    headers:
      Content-Type: application/json
      Authorization: Basic ZmVlZGVyX3VzZXI6ZmVlZGVyX3NlY3JldF8xMjM0
    body: |
      {
        "deviceName": "alice"
      }
  response:
    status: 200
    headers:
      Content-Type: application/json; charset=utf-8
    bodyType:
      deviceId: int
      syncCode: string
  extract:
    deviceId: deviceId
    syncCode: syncCode

# Test get everything before there are feeds or readmarks

- name: v1 Get Feeds Empty
  request:
    method: GET
    path: /api/v1/feeds
    headers:
      Content-Type: application/json
      Authorization: Basic ZmVlZGVyX3VzZXI6ZmVlZGVyX3NlY3JldF8xMjM0
      X-FEEDER-ID: "{{syncCode}}"
      X-FEEDER-DEVICE-ID: "{{deviceId}}"
  response:
    status: 204
    
- name: v1 Get Readmarks Empty
  request:
    method: GET
    path: /api/v1/ereadmark
    headers:
      Content-Type: application/json
      Authorization: Basic ZmVlZGVyX3VzZXI6ZmVlZGVyX3NlY3JldF8xMjM0
      X-FEEDER-ID: "{{syncCode}}"
      X-FEEDER-DEVICE-ID: "{{deviceId}}"
  response:
    status: 204

- name: v1 Get Devices Initial
  request:
    method: GET
    path: /api/v1/devices
    headers:
      Content-Type: application/json
      Authorization: Basic ZmVlZGVyX3VzZXI6ZmVlZGVyX3NlY3JldF8xMjM0
      X-FEEDER-ID: "{{syncCode}}"
      X-FEEDER-DEVICE-ID: "{{deviceId}}"
  response:
    status: 200
    headers:
      Content-Type: application/json; charset=utf-8
    bodyType:
      devices: array
    body: |
      {
        "devices": [
          {
            "deviceId": {{deviceId}},
            "deviceName": "alice"
          }
        ]
      }
